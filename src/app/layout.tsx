import type { ReactNode } from "react";
import { FogoSessionProvider, Network } from "@fogo/sessions-sdk-react";
import { NATIVE_MINT } from "@solana/spl-token";
import { Navbar } from "@/components/layout/Navbar";
import { Footer } from "@/components/layout/Footer";
import "./globals.css"; 
// --- 1. Import PublicKey ---
import { PublicKey } from "@solana/web3.js";

export const metadata = {
  title: 'Next.js',
  description: 'Generated by Next.js',
}

// --- 2. Create the PublicKey object outside the component ---
const sponsorPubKey = new PublicKey("8HnaXmgFJbvvJxSdjeNyWwMXZb85E35NM4XNg6rxuw3w");

export default ({ children }: { children: ReactNode }) => (
  <html lang="en">
    <body>
      <FogoSessionProvider
        network={Network.Testnet}
        
        // --- 3. Pass the PublicKey object, not the string ---
        sponsor={sponsorPubKey}
        paymasterUrl="https://sessions-example.fogo.io/paymaster"
        
        // 2. Set the domain to the ONE this test paymaster is
        //    registered to accept, as shown in the example app.
        domain="https://sessions-example.fogo.io"
        
        tokens={[NATIVE_MINT.toBase58(), "fUSDNGgHkZfwckbr5RLLvRbvqvRcTLdH9hcHJiq4jry"]}
        defaultRequestedLimits={{
          [NATIVE_MINT.toBase58()]: 1_500_000_000n,
          "fUSDNGgHkZfwckbr5RLLvRbvqvRcTLdH9hcHJiq4jry": 1_000_000_000n
        }}
        enableUnlimited
      >
        <Navbar />
        <hr />
        <main>
          {children}
        </main>
        <Footer />
      </FogoSessionProvider>
    </body>
  </html>
);

